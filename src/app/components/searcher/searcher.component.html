<div class="row">
    <div class="col-md-3 filter-block">
      <form [formGroup]="formSearch" (ngSubmit)="buscar(selectPais)">
        <h5 class="text-light text-center tittle">
          <strong>FILTRO DE BUSQUEDA</strong>
        </h5>
        <div class="formGroup">
          <label>Titulo</label>
          <input type="text" formControlName="tittle_publication" class="form-control mr-1 input">
        </div>

        <div class="form-group">
          <label>Autor</label>
          <div formArrayName="users" class="mb-0 pb-0" 
              *ngFor="let item of formSearch.get('users').controls; let i = index; let isFirst = first;">
            <div [formGroupName]="i" class="form-group input-group">
              <input type="text" formControlName="name" class="form-control mr-1 input" *ngIf="isFirst">
              <input type="text" formControlName="name" class="form-control mr-1 input" *ngIf="!isFirst">
              <span class="input-group-btn" *ngIf="!isFirst">
                 <i class="fas fa-user-times mt-2" (click)="deleteAutor(i)" style="color:red; cursor: pointer;"></i>
              </span>
            </div>
          </div>  
        </div>

        <div class="mt-0 mb-2">
          <i (click)="addAutorItem()" style="color: black; cursor: pointer;" class="fas fa-user-plus"> </i>
          <span class="ml-1" (click)="addAutorItem()" style="cursor: pointer;" > Agregar otro autor</span>
        </div>

        <hr>
        <div class="form-group">
          <label for="selectPais">País</label>
          <select  class="selectpicker form-control" id="selectPais" #selectPais data-style="btn" data-live-search="true">
            <option [value]="">Todos</option>
            <optgroup label="América del Norte">
              <option *ngFor="let pais of americaDelNorte" [value]="pais">{{pais}}</option>
            </optgroup>
            <optgroup label="América Central">
              <option *ngFor="let pais of americaCentral" [value]="pais">{{pais}}</option>  
            </optgroup>
            <optgroup label="América del Sur">
              <option *ngFor="let pais of americaDelSur" [value]="pais">{{pais}}</option>
            </optgroup>
          </select>
        </div>
        
        <div class="form-group">
          <label>Intervalo de fechas</label>
          <div class="row">
            <div class="col-md-6">
              <input type="text" formControlName="year_initial" class="form-control mr-1 input"  maxlength="4" placeholder="" >
            </div>
            <div class="col-md-6">
              <input type="text" formControlName="year_final" class="form-control mr-1 input" maxlength="4"  placeholder="" >
            </div>
          </div>
        </div>

        <div class="formGroup">
          <label>Institucion</label>
          <input type="text" formControlName="name_institution" class="form-control mr-1 input">
        </div>

        <button type="submit" class="btn btn-warning btn-lg btn-block">Buscar</button>
      </form>
      <br>
    </div>
    <div class="col-md-9 "> 
      <div class="text-right">
        <button class="btn btn-light" (click)="exportarAexcel()"><i class="fas fa-file-excel" style="color:green; cursor: pointer;"></i> Exportar resultados</button>
      </div>
      <div class="card border-oval" *ngFor="let articulo of listPublicaciones | paginate: configuracionPaginacion" style="position: relative; margin: 5px;">
        <div class="card-body">
          <h5 class="card-title text-primary">{{articulo.tittle}}</h5>
          <p class="card-subtitle mb-1 text-muted"> <small *ngFor="let autor of articulo.authors">{{autor.name}} {{autor.last_name}}</small></p>
          <p class="card-text">{{articulo.abstract}}</p>
          <p class="card-text text-muted float-left">{{articulo.publication_year}}</p>
          <a href="{{articulo.url}}" class="btn btn-info border-oval pl-4 pr-4 pt-1 float-right text-light">Más</a>
        </div>
      </div>

      <div class="text-center"> <br>
        <pagination-template #p="paginationApi" [id]="configuracionPaginacion.id" (pageChange)="cambiarPagina($event)">
          <div class="custom-pagination">
            <div class="pagination-previous" [class.disabled]="p.isFirstPage()">
              <span *ngIf="!p.isFirstPage()" (click)="p.previous()"> <  </span> 
            </div> 
            <div class="page-number" *ngFor="let page of p.pages" [class.current]="p.getCurrent() === page.value">
              <span (click)="p.setCurrent(page.value)" *ngIf="p.getCurrent() !== page.value">{{ page.label }}</span>
              <div *ngIf="p.getCurrent() === page.value">
                <span>{{ page.label }}</span>
              </div>
            </div>
            <div class="pagination-next" [class.disabled]="p.isLastPage()">
              <span *ngIf="!p.isLastPage()" (click)="p.next()"> > </span>
            </div>
          </div>
        </pagination-template>
      </div>
    </div> 
</div>